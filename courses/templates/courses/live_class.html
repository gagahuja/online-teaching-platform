{% extends "courses/base.html" %}
{% load static %}

{% block content %}

<div class="container mt-4"
     data-staff="{{ user.is_staff }}"
     data-active="{{ session.is_active }}">

    <div class="card shadow p-4">
            {% csrf_token %}
        <h2>{{ session.course.title }}</h2>
        <h4 class="text-muted">{{ session.title }}</h4>

        <hr>

        <p>
            <strong>Date:</strong> {{ session.scheduled_date }} <br>
            <strong>Time:</strong> {{ session.start_time }} - {{ session.end_time }}
        </p>

        <hr>

        {% if session.is_active %}
            <div class="alert alert-success">
                Class is Live
            </div>
        {% else %}
            <div class="alert alert-warning">
                Waiting for teacher to start the class...
            </div>
        {% endif %}

        <div class="mt-4">

            {% if user.is_staff %}
                <!-- Teacher Controls -->
                {% if session.is_active %}
                    <button class="btn btn-danger" onclick="toggleSession({{ session.id }}, 'end')">
                        End Class
                    </button>
                {% else %}
                    <button class="btn btn-success" onclick="toggleSession({{ session.id }}, 'start')">
                        Start Class
                    </button>
                {% endif %}
            {% else %}
                <!-- Student Message -->
                {% if session.is_active %}
                    <div class="alert alert-info">
                        You are attending the live class.
                    </div>
                {% endif %}
            {% endif %}

        </div>

    </div>

</div>

<script src="{% static 'courses/live_class.js' %}"></script>

{% endblock %}
